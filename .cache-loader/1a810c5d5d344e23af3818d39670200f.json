{"remainingRequest":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/thread-loader/dist/cjs.js??ref--6-oneOf-1-1!/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-loader/lib/index.js??ref--6-oneOf-1-2!/Users/zhangtengjin/Desktop/byai/topology/node_modules/eslint-loader/index.js??ref--5-0!/Users/zhangtengjin/Desktop/byai/topology/src/lib/components/line/index.tsx","dependencies":[{"path":"/Users/zhangtengjin/Desktop/byai/topology/src/lib/components/line/index.tsx","mtime":1647506177143},{"path":"/Users/zhangtengjin/Desktop/byai/topology/package.json","mtime":1647506605470},{"path":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/cache-loader/dist/cjs.js","mtime":1645756501487},{"path":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/thread-loader/dist/cjs.js","mtime":1645756504722},{"path":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-loader/lib/index.js","mtime":1641784542889},{"path":"/Users/zhangtengjin/Desktop/byai/topology/node_modules/eslint-loader/index.js","mtime":1643179601592}],"contextDependencies":[],"result":["import _toConsumableArray from\"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";import _classCallCheck from\"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _possibleConstructorReturn from\"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/zhangtengjin/Desktop/byai/topology/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}import React from'react';import _ from'lodash';import{LineEditType}from'../../declare';import{Consumer}from'../context';import{computeLinePath,computeTrianglePath}from'../../utils';import config from'../../config';import'./index.less';var Colors={ACTIVE:'#2F82F8',NORMAL:'#AAB7C4'};/* eslint-disable */var Line=/*#__PURE__*/function(_React$Component){_inherits(Line,_React$Component);var _super=_createSuper(Line);function Line(){var _this;_classCallCheck(this,Line);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={hover:false};_this.handleMouseEnter=function(){_this.setState({hover:true});};_this.handleMouseLeave=function(){_this.setState({hover:false});};_this.handleClick=function(e){var _this$props=_this.props,selected=_this$props.selected,context=_this$props.context,data=_this$props.data,onSelect=_this$props.onSelect;var lines=context.selectedData.lines;var multi=e.metaKey||e.ctrlKey;if(!onSelect){return;}if(!multi){onSelect({lines:selected?[]:[data],nodes:[]});return;}onSelect(_objectSpread({},context.selectedData,{lines:selected?lines.filter(function(item){return!_.isEqual(item,data);}):[].concat(_toConsumableArray(lines),[data])}));};return _this;}_createClass(Line,[{key:\"render\",value:function render(){var _this$props2=this.props,start=_this$props2.start,end=_this$props2.end,selected=_this$props2.selected,highLight=_this$props2.highLight,data=_this$props2.data,readOnly=_this$props2.readOnly,lineOffsetY=_this$props2.lineOffsetY,_this$props2$context=_this$props2.context,linking=_this$props2$context.linking,activeLine=_this$props2$context.activeLine;var hover=this.state.hover;var dataJson=data?JSON.stringify({origin:data,po:{start:start,end:end}}):'';var getTriangleStart=function getTriangleStart(){return _objectSpread({},end,{y:end.y-config.line.triangleWidth});};// 只高亮新增或者编辑的当前线\nvar curLinking=linking&&!activeLine.origin&&!data;var lColor=highLight||selected||hover||curLinking?Colors.ACTIVE:data&&data.color||Colors.NORMAL;var transition=linking?'none':config.transition;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"path\",{onClick:this.handleClick,strokeWidth:config.line.triggerWidth,stroke:\"transparent\",fill:\"none\",style:{pointerEvents:'all',transition:transition},d:computeLinePath(start,getTriangleStart(),lineOffsetY),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave}),/*#__PURE__*/React.createElement(\"path\",{onClick:this.handleClick,strokeWidth:highLight||selected||hover?config.line.strokeLargeWidth:config.line.strokeWidth,stroke:lColor,fill:\"none\",style:{pointerEvents:'all',transition:transition},d:computeLinePath(start,getTriangleStart(),lineOffsetY),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave}),/*#__PURE__*/React.createElement(\"path\",{className:readOnly?'':'byai-topology-line-end-triangle',fill:lColor,stroke:\"none\",\"data-type\":LineEditType.EDIT_END,\"data-json\":dataJson,style:{pointerEvents:'all',transition:transition},d:computeTrianglePath(getTriangleStart(),config.line.triangleWidth),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave}));}}]);return Line;}(React.Component);export default(function(props){return/*#__PURE__*/React.createElement(Consumer,null,function(context){return/*#__PURE__*/React.createElement(Line,Object.assign({},props,{context:context}));});});",{"version":3,"sources":["/Users/zhangtengjin/Desktop/byai/topology/src/lib/components/line/index.tsx"],"names":["React","_","LineEditType","Consumer","computeLinePath","computeTrianglePath","config","Colors","ACTIVE","NORMAL","Line","state","hover","handleMouseEnter","setState","handleMouseLeave","handleClick","e","props","selected","context","data","onSelect","lines","selectedData","multi","metaKey","ctrlKey","nodes","filter","item","isEqual","start","end","highLight","readOnly","lineOffsetY","linking","activeLine","dataJson","JSON","stringify","origin","po","getTriangleStart","y","line","triangleWidth","curLinking","lColor","color","transition","triggerWidth","pointerEvents","strokeLargeWidth","strokeWidth","EDIT_END","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport _ from 'lodash';\nimport {\n    IPosition,\n    ITopologyContext,\n    ITopologyLine,\n    LineEditType,\n    ITopologyData,\n} from '../../declare';\nimport { Consumer } from '../context';\nimport { computeLinePath, computeTrianglePath } from '../../utils';\nimport config from '../../config';\nimport './index.less';\n\n\nconst Colors = { ACTIVE: '#2F82F8', NORMAL: '#AAB7C4' };\n/* eslint-disable */\ninterface ILineProps {\n    start: IPosition;\n    end: IPosition;\n    color?: string;\n    lineOffsetY?: number;\n    data?: ITopologyLine;\n    arrow?: boolean;\n    readOnly?: boolean;\n    context?: ITopologyContext;\n    selected?: boolean;\n    highLight?: boolean;\n    onSelect?: (data: ITopologyData) => void;\n}\n\ninterface ILineState {\n    hover: boolean;\n}\n\nclass Line extends React.Component<ILineProps, ILineState> {\n    state: ILineState = { hover: false };\n\n    handleMouseEnter = () => {\n        this.setState({ hover: true });\n    }\n\n    handleMouseLeave = () => {\n        this.setState({ hover: false });\n    }\n\n    handleClick = (e: React.MouseEvent<SVGPathElement, MouseEvent>) => {\n        const {\n            selected,\n            context,\n            data,\n            onSelect,\n        } = this.props;\n        const { lines } = context.selectedData;\n        const multi = e.metaKey || e.ctrlKey;\n        if (!onSelect) {\n            return;\n        }\n\n        if (!multi) {\n            onSelect({\n                lines: selected ? [] : [data],\n                nodes: [],\n            });\n            return;\n        }\n        onSelect({\n            ...context.selectedData,\n            lines: selected\n                ? lines.filter(item => !_.isEqual(item, data))\n                : [...lines, data],\n        });\n    }\n\n    render() {\n        const {\n            start,\n            end,\n            selected,\n            highLight,\n            data,\n            readOnly,\n            lineOffsetY,\n            context: { linking, activeLine },\n        } = this.props;\n\n        const { hover } = this.state;\n        const dataJson = data ? JSON.stringify({ origin: data, po: { start, end } }) : '';\n        const getTriangleStart = () => ({ ...end, y: end.y - config.line.triangleWidth });\n        // 只高亮新增或者编辑的当前线\n        const curLinking = linking && !activeLine.origin && !data;\n        const lColor = highLight || selected || hover || curLinking ? Colors.ACTIVE : (data && data.color || Colors.NORMAL);\n        const transition = linking ? 'none' : config.transition;\n        return (\n            <React.Fragment>\n                <path\n                    onClick={this.handleClick}\n                    strokeWidth={config.line.triggerWidth}\n                    stroke=\"transparent\"\n                    fill=\"none\"\n                    style={{ pointerEvents: 'all', transition }}\n                    d={computeLinePath(start, getTriangleStart(), lineOffsetY)}\n                    onMouseEnter={this.handleMouseEnter}\n                    onMouseLeave={this.handleMouseLeave}\n                />\n                <path\n                    onClick={this.handleClick}\n                    strokeWidth={highLight || selected || hover ? config.line.strokeLargeWidth : config.line.strokeWidth}\n                    stroke={lColor}\n                    fill=\"none\"\n                    style={{ pointerEvents: 'all', transition }}\n                    d={computeLinePath(start, getTriangleStart(), lineOffsetY)}\n                    onMouseEnter={this.handleMouseEnter}\n                    onMouseLeave={this.handleMouseLeave}\n                />\n                <path\n                    className={readOnly ? '' : 'byai-topology-line-end-triangle'}\n                    fill={lColor}\n                    stroke=\"none\"\n                    data-type={LineEditType.EDIT_END}\n                    data-json={dataJson}\n                    style={{ pointerEvents: 'all', transition }}\n                    d={computeTrianglePath(getTriangleStart(), config.line.triangleWidth)}\n                    onMouseEnter={this.handleMouseEnter}\n                    onMouseLeave={this.handleMouseLeave}\n                />\n            </React.Fragment>\n        );\n    }\n}\n\nexport default (props: ILineProps) => (\n    <Consumer>\n        {context => <Line {...props} context={context} />}\n    </Consumer>\n);\n"]}]}